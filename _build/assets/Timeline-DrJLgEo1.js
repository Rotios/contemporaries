import{q as Z,b as v,t as C,w as E,D as q,A as $,j as N,G as Q,z as P,J as H,m as U,S as ne,d as A,K as L,L as J,n as ie,M as le}from"./web-BonQDxMR.js";var ae=E("<ul class=pms-dropdown>"),re=E('<div class=pms-container>Search for people:&nbsp;<div class=pms-tags></div><input type=text placeholder="Type at least 3 characters..."class=pms-input><!$><!/>'),se=E("<span class=pms-tag><!$><!/><button type=button>×"),oe=E("<li class=pms-option>");function ce(e){const[m,b]=v(""),[S,n]=v(!1),r=()=>{const i=m().toLowerCase();return i.length<3?[]:e.people.filter(l=>l.name.toLowerCase().includes(i)&&!e.value.includes(l.name)).slice(0,100)};function x(i){e.onChange([...e.value,i]),b(""),n(!1)}function k(i){e.onChange(e.value.filter(l=>l!==i))}return(()=>{var i=C(re),l=i.firstChild,g=l.nextSibling,c=g.nextSibling,_=c.nextSibling,[j,F]=q(_.nextSibling);return $(g,N(H,{get each(){return e.value},children:o=>(()=>{var u=C(se),w=u.firstChild,[t,f]=q(w.nextSibling),d=t.nextSibling;return $(u,o,t,f),d.$$click=()=>k(o),Q(d,"aria-label",`Remove ${o}`),P(),u})()})),c.addEventListener("blur",()=>setTimeout(()=>n(!1),120)),c.addEventListener("focus",()=>n(!0)),c.$$input=o=>{b(o.currentTarget.value),n(!0)},$(i,N(ne,{get when(){return U(()=>!!S())()&&r().length>0},get children(){var o=C(ae);return $(o,N(H,{get each(){return r()},children:u=>(()=>{var w=C(oe);return w.$$mousedown=()=>x(u.name),$(w,()=>u.name),P(),w})()})),o}}),j,F),A(()=>L(c,"value",m())),P(),i})()}Z(["input","click","mousedown"]);function T(e){if(!e)return"";const m=String(e).split(".")[0];return parseInt(m,10)}function ue(e){return{media:{url:"",caption:e.name.replace(/_/g," "),credit:[e.citizenship_1_b,e.citizenship_2_b].filter(Boolean).join(", ")},start_date:{year:T(e.birth_estimation||e.birth)},end_date:e.death_estimation||e.death?{year:T(e.death_estimation||e.death)}:void 0,text:{headline:e.name.replace(/_/g," "),text:`<p>${e.level3_main_occ||e.level2_main_occ||e.level1_main_occ||""} (${T(e.birth_estimation||e.birth)||"?"}–${T(e.death_estimation||e.death)||"?"})<br/>${e.citizenship_1_b||""}${e.citizenship_2_b?", "+e.citizenship_2_b:""}</p>`},unique_id:e.wikidata_code||e.curid}}function K(e){return{birth:T(e.birth_estimation||e.birth),death:T(e.death_estimation||e.death)}}function de(e,m,b=25){let S=[];const n=new Set(e.map(r=>r.wikidata_code||r.curid||r.name));for(const r of e){const{birth:x,death:k}=K(r);let i=0;for(const l of m){if(l===r)continue;const g=l.wikidata_code||l.curid||l.name;if(n.has(g))continue;const{birth:c,death:_}=K(l);if(c&&_&&x&&k&&c<=k&&_>=x&&(S.push(l),n.add(g),i++,i>=b))break}}return S}var me=E('<div class=timeline-container><button class=fullscreen-btn aria-label="Go Fullscreen">⛶ Fullscreen</button><div class=timeline-controls><!$><!/><label></label><br><label style=margin-left:1em;>Number of contemporaries:&nbsp;&nbsp;<input type=text inputmode=numeric pattern=[0-9]* class=timeline-num-input style=width:4em; autocomplete=off></label></div><div id=timeline-embed style=width:100%;height:600px></div><div class=timeline-pagination><div></div><button class=timeline-pagination-btn>Prev</button><button class=timeline-pagination-btn>Next'),_e=E("<div class=timeline-error>");const I=250,he=25,O="/contemporaries";function pe(){const[e,m]=v([]),[b,S]=v([]),[n,r]=v(0),[x,k]=v(null),[i,l]=v(null),[g,c]=v(5);let _=null;async function j(){l(null);try{const t=await fetch(`${O}/data/ranking/people_part_1.json`);if(!t.ok)throw new Error(`Failed to load people_part_1.json: ${t.statusText}`);const f=await t.json();m(f);const d=[];for(let s=2;s<=he;s++)d.push(fetch(`${O}/data/ranking/people_part_${s}.json`).then(h=>{if(!h.ok)throw new Error(`Failed to load people_part_${s}.json: ${h.statusText}`);return h.json()}).catch(h=>(console.error(h),[])));const y=await Promise.all(d);m([...f,...y.flat()])}catch(t){m([]),l(t.message||"Failed to load data.")}}j();const F=()=>{if(b().length===0)return e();const t=e().filter(s=>b().includes(s.name.replace(/_/g," "))),f=de(t,e(),g()),d=[...t,...f],y=new Set;return d.filter(s=>{const h=s.wikidata_code||s.curid||s.name;return y.has(h)?!1:(y.add(h),!0)})},o=()=>F().slice(n()*I,(n()+1)*I);J(()=>{const t=o().map(ue);k({title:{text:{headline:"Contemporaries",text:"<p>See the contemporaries of your favorite people.</p>"},media:{url:"./contemporaries.png"}},events:t})}),J(()=>{const t=x();t&&window.TL&&window.TL.Timeline&&(_&&_.destroy?.(),_=new window.TL.Timeline("timeline-embed",t))});let u;function w(){document.fullscreenElement?document.exitFullscreen?.():u?.requestFullscreen&&u.requestFullscreen()}return ie(()=>{_&&_.destroy?.()}),(()=>{var t=C(me),f=t.firstChild,d=f.nextSibling,y=d.firstChild,[s,h]=q(y.nextSibling),G=s.nextSibling,V=G.nextSibling,W=V.nextSibling,X=W.firstChild,D=X.nextSibling,ee=d.nextSibling,te=ee.nextSibling,M=te.firstChild,z=M.nextSibling,R=z.nextSibling,B=u;return typeof B=="function"?le(B,t):u=t,f.$$click=w,$(d,(()=>{var a=U(()=>!!i());return()=>a()&&(()=>{var p=C(_e);return $(p,i),p})()})(),s,h),$(G,N(ce,{get people(){return e().map(a=>({name:a.name.replace(/_/g," ")}))},get value(){return b()},onChange:a=>{S(a),r(0)}})),D.$$input=a=>{const p=parseInt(a.currentTarget.value.replace(/\D/g,""),10);!isNaN(p)&&p>0?c(p):a.currentTarget.value===""&&c(1)},Q(D,"spellcheck",!1),$(M,()=>`Showing the top ${n()*o().length}-${(n()+1)*o().length} of ${F().length} people`),z.$$click=()=>r(n()-1),R.$$click=()=>r(n()+1),A(a=>{var p=n()===0,Y=(n()+1)*I>=F().length;return p!==a.e&&L(z,"disabled",a.e=p),Y!==a.t&&L(R,"disabled",a.t=Y),a},{e:void 0,t:void 0}),A(()=>L(D,"value",g())),P(),t})()}Z(["click","input"]);export{pe as T};
