import{q as U,b as g,t as T,w as F,D as L,A as c,j,H as V,z as D,I as K,m as X,S as oe,d as B,J as I,K as O,n as ce,L as ue}from"./web-Cgzb-LDx.js";import{u as ee}from"./useWindowWidth-CX7ZgkkB.js";var de=F("<ul class=pms-dropdown>"),me=F('<div class=pms-container><!$><!/><div class=pms-tags></div><input type=text placeholder="Type at least 3 characters..."class=pms-input><!$><!/>'),_e=F("<span class=pms-tag><!$><!/><button type=button>×"),he=F("<li class=pms-option>");function $e(e){const m=ee(),[$,v]=g(""),[s,i]=g(!1),w=()=>{const n=$().toLowerCase();return n.length<3?[]:e.people.filter(o=>o.name.toLowerCase().includes(n)&&!e.value.includes(o.name)).slice(0,100)};function k(n){e.onChange([...e.value,n]),v(""),i(!1)}function S(n){e.onChange(e.value.filter(o=>o!==n))}return(()=>{var n=T(me),o=n.firstChild,[f,C]=L(o.nextSibling),p=f.nextSibling,x=p.nextSibling,N=x.nextSibling,[P,y]=L(N.nextSibling);return c(n,()=>m()>600?"Search for people:":"",f,C),c(p,j(K,{get each(){return e.value},children:u=>(()=>{var t=T(_e),l=t.firstChild,[_,b]=L(l.nextSibling),a=_.nextSibling;return c(t,u,_,b),a.$$click=()=>S(u),V(a,"aria-label",`Remove ${u}`),D(),t})()})),x.addEventListener("blur",()=>setTimeout(()=>i(!1),120)),x.addEventListener("focus",()=>i(!0)),x.$$input=u=>{v(u.currentTarget.value),i(!0)},c(n,j(oe,{get when(){return X(()=>!!s())()&&w().length>0},get children(){var u=T(de);return c(u,j(K,{get each(){return w()},children:t=>(()=>{var l=T(he);return l.$$mousedown=()=>k(t.name),c(l,()=>t.name),D(),l})()})),u}}),P,y),B(()=>I(x,"value",$())),D(),n})()}U(["input","click","mousedown"]);function E(e){if(!e)return"";const m=String(e).split(".")[0];return parseInt(m,10)}function fe(e){return{media:{url:"",caption:e.name.replace(/_/g," "),credit:[e.citizenship_1_b,e.citizenship_2_b].filter(Boolean).join(", ")},start_date:{year:E(e.birth_estimation||e.birth)},end_date:e.death_estimation||e.death?{year:E(e.death_estimation||e.death)}:void 0,text:{headline:e.name.replace(/_/g," "),text:`<p>${e.level3_main_occ||e.level2_main_occ||e.level1_main_occ||""} (${E(e.birth_estimation||e.birth)||"?"}–${E(e.death_estimation||e.death)||"?"})<br/>${e.citizenship_1_b||""}${e.citizenship_2_b?", "+e.citizenship_2_b:""}</p>`},unique_id:e.wikidata_code||e.curid}}function Z(e){return{birth:E(e.birth_estimation||e.birth),death:E(e.death_estimation||e.death)}}function pe(e,m,$=25){let v=[];const s=new Set(e.map(i=>i.wikidata_code||i.curid||i.name));for(const i of e){const{birth:w,death:k}=Z(i);let S=0;for(const n of m){if(n===i)continue;const o=n.wikidata_code||n.curid||n.name;if(s.has(o))continue;const{birth:f,death:C}=Z(n);if(f&&C&&w&&k&&f<=k&&C>=w&&(v.push(n),s.add(o),S++,S>=$))break}}return v}var be=F('<div class=timeline-container><button class=fullscreen-btn aria-label="Go Fullscreen">⛶ <!$><!/></button><div class=timeline-controls><!$><!/><label></label><br><label class=timeline-label>Number of contemporaries:&nbsp;&nbsp;<input type=text inputmode=numeric pattern=[0-9]* class=timeline-num-input style=width:4em; autocomplete=off></label></div><div id=timeline-embed style=width:100%;height:600px></div><div class=timeline-pagination><div></div><button class=timeline-pagination-btn>Prev</button><button class=timeline-pagination-btn>Next'),ge=F("<div class=timeline-error>");const R=250,ve=25,Q="/contemporaries";function xe(){const[e,m]=g([]),[$,v]=g([]),[s,i]=g(0),[w,k]=g(null),[S,n]=g(null),[o,f]=g(5),C=ee();let p=null;async function x(){n(null);try{const t=await fetch(`${Q}/data/ranking/people_part_1.json`);if(!t.ok)throw new Error(`Failed to load people_part_1.json: ${t.statusText}`);const l=await t.json();m(l);const _=[];for(let a=2;a<=ve;a++)_.push(fetch(`${Q}/data/ranking/people_part_${a}.json`).then(d=>{if(!d.ok)throw new Error(`Failed to load people_part_${a}.json: ${d.statusText}`);return d.json()}).catch(d=>(console.error(d),[])));const b=await Promise.all(_);m([...l,...b.flat()])}catch(t){m([]),n(t.message||"Failed to load data.")}}x();const N=()=>{if($().length===0)return e();const t=e().filter(a=>$().includes(a.name.replace(/_/g," "))),l=pe(t,e(),o()),_=[...t,...l],b=new Set;return _.filter(a=>{const d=a.wikidata_code||a.curid||a.name;return b.has(d)?!1:(b.add(d),!0)})},P=()=>N().slice(s()*R,(s()+1)*R);O(()=>{const t=P().map(fe);k({title:{text:{headline:"Contemporaries",text:"<p>See the contemporaries of your favorite people.</p>"},media:{url:"./contemporaries.png"}},events:t})}),O(()=>{const t=w();t&&window.TL&&window.TL.Timeline&&(p&&p.destroy?.(),p=new window.TL.Timeline("timeline-embed",t))});let y;function u(){document.fullscreenElement?document.exitFullscreen?.():y?.requestFullscreen&&y.requestFullscreen()}return ce(()=>{p&&p.destroy?.()}),(()=>{var t=T(be),l=t.firstChild,_=l.firstChild,b=_.nextSibling,[a,d]=L(b.nextSibling),z=l.nextSibling,te=z.firstChild,[G,ne]=L(te.nextSibling),H=G.nextSibling,ie=H.nextSibling,le=ie.nextSibling,ae=le.firstChild,q=ae.nextSibling,re=z.nextSibling,se=re.nextSibling,M=se.firstChild,A=M.nextSibling,W=A.nextSibling,Y=y;return typeof Y=="function"?ue(Y,t):y=t,l.$$click=u,c(l,()=>C()>600?"Fullscreen":"",a,d),c(z,(()=>{var r=X(()=>!!S());return()=>r()&&(()=>{var h=T(ge);return c(h,S),h})()})(),G,ne),c(H,j($e,{get people(){return e().map(r=>({name:r.name.replace(/_/g," ")}))},get value(){return $()},onChange:r=>{v(r),i(0)}})),q.$$input=r=>{const h=parseInt(r.currentTarget.value.replace(/\D/g,""),10);!isNaN(h)&&h>0?f(h):r.currentTarget.value===""&&f(1)},V(q,"spellcheck",!1),c(M,()=>`Showing the top ${s()*P().length}-${(s()+1)*P().length} of ${N().length} people`),A.$$click=()=>i(s()-1),W.$$click=()=>i(s()+1),B(r=>{var h=s()===0,J=(s()+1)*R>=N().length;return h!==r.e&&I(A,"disabled",r.e=h),J!==r.t&&I(W,"disabled",r.t=J),r},{e:void 0,t:void 0}),B(()=>I(q,"value",o())),D(),t})()}U(["click","input"]);export{xe as T};
