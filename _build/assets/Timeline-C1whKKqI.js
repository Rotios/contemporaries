import{q as U,b,t as T,w as E,D as P,A as c,j as L,H as V,z as D,I as K,m as X,S as oe,d as W,J as j,K as O,n as ce,L as ue}from"./web-Cgzb-LDx.js";import{u as ee}from"./useWindowWidth-CX7ZgkkB.js";var de=E("<ul class=pms-dropdown>"),me=E('<div class=pms-container><!$><!/><div class=pms-tags></div><input type=text placeholder="Type at least 3 characters..."class=pms-input><!$><!/>'),_e=E("<span class=pms-tag><!$><!/><button type=button>×"),pe=E("<li class=pms-option>");function he(e){const m=ee(),[h,v]=b(""),[s,i]=b(!1),w=()=>{const n=h().toLowerCase();return n.length<3?[]:e.people.filter(o=>o.name.toLowerCase().includes(n)&&!e.value.includes(o.name)).slice(0,100)};function k(n){e.onChange([...e.value,n]),v(""),i(!1)}function S(n){e.onChange(e.value.filter(o=>o!==n))}return(()=>{var n=T(me),o=n.firstChild,[$,C]=P(o.nextSibling),f=$.nextSibling,x=f.nextSibling,F=x.nextSibling,[N,y]=P(F.nextSibling);return c(n,()=>m()>600?"Search for people:":"",$,C),c(f,L(K,{get each(){return e.value},children:u=>(()=>{var t=T(_e),l=t.firstChild,[_,g]=P(l.nextSibling),a=_.nextSibling;return c(t,u,_,g),a.$$click=()=>S(u),V(a,"aria-label",`Remove ${u}`),D(),t})()})),x.addEventListener("blur",()=>setTimeout(()=>i(!1),120)),x.addEventListener("focus",()=>i(!0)),x.$$input=u=>{v(u.currentTarget.value),i(!0)},c(n,L(oe,{get when(){return X(()=>!!s())()&&w().length>0},get children(){var u=T(de);return c(u,L(K,{get each(){return w()},children:t=>(()=>{var l=T(pe);return l.$$mousedown=()=>k(t.name),c(l,()=>t.name),D(),l})()})),u}}),N,y),W(()=>j(x,"value",h())),D(),n})()}U(["input","click","mousedown"]);function I(e){if(!e)return"";const m=String(e).split(".")[0];return parseInt(m,10)}function $e(e){return{media:{url:`https://en.wikipedia.org/wiki/${e.name}`,caption:e.name.replace(/_/g," "),credit:"Wikipedia"},start_date:{year:I(e.birth_estimation||e.birth)},end_date:e.death_estimation||e.death?{year:I(e.death_estimation||e.death)}:void 0,text:{headline:e.name.replace(/_/g," "),text:`<p>${e.level3_main_occ||e.level2_main_occ||e.level1_main_occ||""}<br/>${(e.citizenship_1_b||"")?.replace(/_/g," ")}${(e.citizenship_2_b?", "+e.citizenship_2_b:"")?.replace(/_/g," ")}</p>`},unique_id:e.wikidata_code||e.curid}}function Z(e){return{birth:I(e.birth_estimation||e.birth),death:I(e.death_estimation||e.death)}}function fe(e,m,h=25){let v=[];const s=new Set(e.map(i=>i.wikidata_code||i.curid||i.name));for(const i of e){const{birth:w,death:k}=Z(i);let S=0;for(const n of m){if(n===i)continue;const o=n.wikidata_code||n.curid||n.name;if(s.has(o))continue;const{birth:$,death:C}=Z(n);if($&&C&&w&&k&&$<=k&&C>=w&&(v.push(n),s.add(o),S++,S>=h))break}}return v}var ge=E('<div class=timeline-container><button class=fullscreen-btn aria-label="Go Fullscreen">⛶ <!$><!/></button><div class=timeline-controls><!$><!/><label></label><br><label class=timeline-label>Number of contemporaries:&nbsp;&nbsp;<input type=text inputmode=numeric pattern=[0-9]* class=timeline-num-input style=width:4em; autocomplete=off></label></div><div id=timeline-embed style=width:100%;height:600px></div><div class=timeline-pagination><div></div><button class=timeline-pagination-btn>Prev</button><button class=timeline-pagination-btn>Next'),be=E("<div class=timeline-error>");const R=250,ve=25,Q="/contemporaries";function xe(){const[e,m]=b([]),[h,v]=b([]),[s,i]=b(0),[w,k]=b(null),[S,n]=b(null),[o,$]=b(5),C=ee();let f=null;async function x(){n(null);try{const t=await fetch(`${Q}/data/ranking/people_part_1.json`);if(!t.ok)throw new Error(`Failed to load people_part_1.json: ${t.statusText}`);const l=await t.json();m(l);const _=[];for(let a=2;a<=ve;a++)_.push(fetch(`${Q}/data/ranking/people_part_${a}.json`).then(d=>{if(!d.ok)throw new Error(`Failed to load people_part_${a}.json: ${d.statusText}`);return d.json()}).catch(d=>(console.error(d),[])));const g=await Promise.all(_);m([...l,...g.flat()])}catch(t){m([]),n(t.message||"Failed to load data.")}}x();const F=()=>{if(h().length===0)return e();const t=e().filter(a=>h().includes(a.name.replace(/_/g," "))),l=fe(t,e(),o()),_=[...t,...l],g=new Set;return _.filter(a=>{const d=a.wikidata_code||a.curid||a.name;return g.has(d)?!1:(g.add(d),!0)})},N=()=>F().slice(s()*R,(s()+1)*R);O(()=>{const t=N().map($e);k({title:{text:{headline:"Contemporaries",text:"<p>See the contemporaries of your favorite people.</p>"},media:{url:"./contemporaries.png"}},events:t})}),O(()=>{const t=w();t&&window.TL&&window.TL.Timeline&&(f&&f.destroy?.(),f=new window.TL.Timeline("timeline-embed",t))});let y;function u(){document.fullscreenElement?document.exitFullscreen?.():y?.requestFullscreen?y.requestFullscreen():alert("Fullscreen is not supported on this device/browser.")}return ce(()=>{f&&f.destroy?.()}),(()=>{var t=T(ge),l=t.firstChild,_=l.firstChild,g=_.nextSibling,[a,d]=P(g.nextSibling),q=l.nextSibling,te=q.firstChild,[G,ne]=P(te.nextSibling),H=G.nextSibling,ie=H.nextSibling,le=ie.nextSibling,ae=le.firstChild,A=ae.nextSibling,re=q.nextSibling,se=re.nextSibling,M=se.firstChild,z=M.nextSibling,Y=z.nextSibling,B=y;return typeof B=="function"?ue(B,t):y=t,l.$$click=u,c(l,()=>C()>600?"Fullscreen":"",a,d),c(q,(()=>{var r=X(()=>!!S());return()=>r()&&(()=>{var p=T(be);return c(p,S),p})()})(),G,ne),c(H,L(he,{get people(){return e().map(r=>({name:r.name.replace(/_/g," ")}))},get value(){return h()},onChange:r=>{v(r),i(0)}})),A.$$input=r=>{const p=parseInt(r.currentTarget.value.replace(/\D/g,""),10);!isNaN(p)&&p>0?$(p):r.currentTarget.value===""&&$(1)},V(A,"spellcheck",!1),c(M,()=>`Showing the top ${s()*N().length}-${(s()+1)*N().length} of ${F().length} people`),z.$$click=()=>i(s()-1),Y.$$click=()=>i(s()+1),W(r=>{var p=s()===0,J=(s()+1)*R>=F().length;return p!==r.e&&j(z,"disabled",r.e=p),J!==r.t&&j(Y,"disabled",r.t=J),r},{e:void 0,t:void 0}),W(()=>j(A,"value",o())),D(),t})()}U(["click","input"]);export{xe as T};
