import{q as H,b,t as k,w as C,D,A as f,j as F,H as Z,z as P,I as R,m as M,S as Q,d as Y,J as N,K as B,n as U,L as V}from"./web-Cgzb-LDx.js";var W=C("<ul class=pms-dropdown>"),X=C('<div class=pms-container><div class=pms-tags></div><input type=text placeholder="Type at least 3 characters..."class=pms-input><!$><!/>'),ee=C("<span class=pms-tag><!$><!/><button type=button>×"),te=C("<li class=pms-option>");function ne(e){const[d,$]=b(""),[v,i]=b(!1),r=()=>{const a=d().toLowerCase();return a.length<3?[]:e.people.filter(n=>n.name.toLowerCase().includes(a)&&!e.value.includes(n.name)).slice(0,100)};function w(a){e.onChange([...e.value,a]),$(""),i(!1)}function S(a){e.onChange(e.value.filter(n=>n!==a))}return(()=>{var a=k(X),n=a.firstChild,l=n.nextSibling,x=l.nextSibling,[g,T]=D(x.nextSibling);return f(n,F(R,{get each(){return e.value},children:o=>(()=>{var p=k(ee),t=p.firstChild,[u,m]=D(t.nextSibling),h=u.nextSibling;return f(p,o,u,m),h.$$click=()=>S(o),Z(h,"aria-label",`Remove ${o}`),P(),p})()})),l.addEventListener("blur",()=>setTimeout(()=>i(!1),120)),l.addEventListener("focus",()=>i(!0)),l.$$input=o=>{$(o.currentTarget.value),i(!0)},f(a,F(Q,{get when(){return M(()=>!!v())()&&r().length>0},get children(){var o=k(W);return f(o,F(R,{get each(){return r()},children:p=>(()=>{var t=k(te);return t.$$mousedown=()=>w(p.name),f(t,()=>p.name),P(),t})()})),o}}),g,T),Y(()=>N(l,"value",d())),P(),a})()}H(["input","click","mousedown"]);function y(e){if(!e)return"";const d=String(e).split(".")[0];return parseInt(d,10)}function ie(e){return{media:{url:"",caption:e.name.replace(/_/g," "),credit:[e.citizenship_1_b,e.citizenship_2_b].filter(Boolean).join(", ")},start_date:{year:y(e.birth_estimation||e.birth)},end_date:e.death_estimation||e.death?{year:y(e.death_estimation||e.death)}:void 0,text:{headline:e.name.replace(/_/g," "),text:`<p>${e.level3_main_occ||e.level2_main_occ||e.level1_main_occ||""} (${y(e.birth_estimation||e.birth)||"?"}–${y(e.death_estimation||e.death)||"?"})<br/>${e.citizenship_1_b||""}${e.citizenship_2_b?", "+e.citizenship_2_b:""}</p>`},unique_id:e.wikidata_code||e.curid}}function G(e){return{birth:y(e.birth_estimation||e.birth),death:y(e.death_estimation||e.death)}}function ae(e,d,$=5){let v=[];const i=new Set(e.map(r=>r.wikidata_code||r.curid||r.name));for(const r of e){const{birth:w,death:S}=G(r);let a=0;for(const n of d){if(n===r)continue;const l=n.wikidata_code||n.curid||n.name;if(i.has(l))continue;const{birth:x,death:g}=G(n);if(x&&g&&w&&S&&x<=S&&g>=w&&(v.push(n),i.add(l),a++,a>=$))break}}return v}var le=C('<div class=timeline-container><button class=fullscreen-btn aria-label="Go Fullscreen">⛶ Fullscreen</button><div class=timeline-controls><!$><!/><label></label></div><div id=timeline-embed style=width:100%;height:600px></div><div class=timeline-pagination><div></div><button class=timeline-pagination-btn>Prev</button><button class=timeline-pagination-btn>Next'),re=C("<div class=timeline-error>");const j=250,oe=25;function ce(){const[e,d]=b([]),[$,v]=b([]),[i,r]=b(0),[w,S]=b(null),[a,n]=b(null);let l=null;async function x(){n(null);try{const t=await fetch("/contemporaries/data/ranking/people_part_1.json");if(!t.ok)throw new Error(`Failed to load people_part_1.json: ${t.statusText}`);const u=await t.json();d(u);const m=[];for(let s=2;s<=oe;s++)m.push(fetch(`/contemporaries/data/ranking/people_part_${s}.json`).then(_=>{if(!_.ok)throw new Error(`Failed to load people_part_${s}.json: ${_.statusText}`);return _.json()}).catch(_=>(console.error(_),[])));const h=await Promise.all(m);d([...u,...h.flat()])}catch(t){d([]),n(t.message||"Failed to load data.")}}x();const g=()=>{if($().length===0)return e();const t=e().filter(s=>$().includes(s.name.replace(/_/g," "))),u=ae(t,e()),m=[...t,...u],h=new Set;return m.filter(s=>{const _=s.wikidata_code||s.curid||s.name;return h.has(_)?!1:(h.add(_),!0)})},T=()=>g().slice(i()*j,(i()+1)*j);B(()=>{const t=T().map(ie);S({title:{text:{headline:"Contemporaries",text:"<p>See the contemporaries of your favorite people.</p>"},media:{url:"./contemporaries.png"}},events:t})}),B(()=>{const t=w();t&&window.TL&&window.TL.Timeline&&(l&&l.destroy?.(),l=new window.TL.Timeline("timeline-embed",t))});let o;function p(){document.fullscreenElement?document.exitFullscreen?.():o?.requestFullscreen&&o.requestFullscreen()}return U(()=>{l&&l.destroy?.()}),(()=>{var t=k(le),u=t.firstChild,m=u.nextSibling,h=m.firstChild,[s,_]=D(h.nextSibling),J=s.nextSibling,K=m.nextSibling,O=K.nextSibling,z=O.firstChild,L=z.nextSibling,I=L.nextSibling,q=o;return typeof q=="function"?V(q,t):o=t,u.$$click=p,f(m,(()=>{var c=M(()=>!!a());return()=>c()&&(()=>{var E=k(re);return f(E,a),E})()})(),s,_),f(J,F(ne,{get people(){return e().map(c=>({name:c.name.replace(/_/g," ")}))},get value(){return $()},onChange:c=>{v(c),r(0)}})),f(z,()=>`Showing the top ${i()*T().length}-${(i()+1)*T().length} of ${g().length} people`),L.$$click=()=>r(i()-1),I.$$click=()=>r(i()+1),Y(c=>{var E=i()===0,A=(i()+1)*j>=g().length;return E!==c.e&&N(L,"disabled",c.e=E),A!==c.t&&N(I,"disabled",c.t=A),c},{e:void 0,t:void 0}),P(),t})()}H(["click"]);export{ce as T};
